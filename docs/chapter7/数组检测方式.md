# 什么才是正确的javascript数组检测方式

　　对于确定某个对象是不是数组，一直是数组的一个经典问题。本文专门将该问题择出来，介绍什么才是正确的javascript数组检测方式 

 

### typeof

　　首先，使用最常用的类型检测工具——typeof运算符

```
var arr = [1,2,3];
console.log(typeof arr);//'object'
```

　　前面已经介绍过，数组的本质 是一种特殊的对象，所以返回'object'。typeof运算符只能用来区分原始类型和对象类型，对于更具体的对象类型是无法鉴别出来的。

 

### instanceof

　　这时，该instanceof运算符出场了，instanceof运算符用来判断一个对象是否是特定构造函数的实例

```javascript
var arr = [1,2,3];
console.log(arr instanceof Array);//true

var str = '123';
console.log(str instanceof Array);//false
```

　　看上去很实用。但，这时就引出了数组检测的经典场景——网页中包含多个框架

index.html

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script>
        window.onload = function () {
            var fwindow = window.framePage.contentWindow // frame 页面的window对象
            var fArray = fwindow.Array  // frame 页面的Array
            var fdata = fwindow.data  // frame 页面的 data [1,2,3]
            console.log(fdata instanceof fArray) // true
            console.log(fdata instanceof Array) // false
        }
    </script>
    <title>Document</title>
</head>
<body>
    <iframe id="framePage" src="frame.html" frameborder="0"></iframe>
</body>
</html>
```

Frame.html

~~~html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script>
        window.data = [1,2,3]
    </script>
</head>
<body>
    <p>frame page</p>
</body>
</html>
~~~

由于 `iframe` 是在独立的环境中运行的，所以 `fdata instanceof Array` 返回的 `false` 。

 

### toString

　　typeof操作符在这里帮不上忙，而instanceof操作符只能用于简单的情形，这时就需要祭出大杀器——[toString()](http://www.cnblogs.com/xiaohuochai/p/5557387.html)，通过引用Object的toString()方法来检查对象的类属性，对数组而言该属性的值总是"Array"

```javascript
var arr = [1,2,3];
console.log(Object.prototype.toString.call(arr) === '[object Array]');//true
```

　　或者，可以自定义类型识别函数

```javascript
function type(obj){
    return Object.prototype.toString.call(obj).slice(8,-1).toLowerCase();
}
var arr = [1,2,3];
console.log(type(arr));//'array'
```

 

### isArray

　　为了让数组检测更方便，ECMAScript5新增了Array.isArray()方法。该方法的目的是最终确定某个值到底是不是数组，而不管它在哪个全局环境中创建的 

```javascript
var arr = [1,2,3];
console.log(Array.isArray([]));//true
console.log(Array.isArray({}));//false
console.log(Array.isArray(arr));//true
```

